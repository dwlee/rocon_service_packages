{"id":"420e696226483fee96cca53e1e20df36","js":"var nao_res;\nvar is_turn_off;\nvar item;\nvar rf233_checker_res;\nvar sensor;\n\n\n$engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] Live authoring start'));(function(nao_res){ if(nao_res){   $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] nao resource allocation success'));$engine.subscribe('/voice_command', 'std_msgs/String', function(item){   $engine.print(\"Rocon Authoring :\" + JSON.stringify(String('[Live Authoring] voice command: ') + String(item['data'])));if (item['data'] == 'warning') {\n      $engine.scheduledPublish(nao_res, \"/notice\", \"rocon_demo_msgs/Notice\", ({\"message\":'warning',\"level\":1}));} else if (item['data'] == 'danger') {\n      $engine.scheduledPublish(nao_res, \"/notice\", \"rocon_demo_msgs/Notice\", ({\"message\":'danger',\"level\":2}));}\n   }); }else{   $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] nao resource allocation fail'));} })($engine.allocateResource(\"concert_common_rapps/notice\", \"rocon:/aldebaran_nao\", [{\"remap_from\":\"/notice\",\"remap_to\":\"/notice\"}], [], {\"timeout\":\"15000000\",\"type\":\"dynamic\"}));is_turn_off = false;\n(function(rf233_checker_res){ if(rf233_checker_res){   $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] rf233 checker resource allocation success'));$engine.scheduledSubscribe(rf233_checker_res, 'rf233_sensor_event', 'std_msgs/String', function(sensor){   if (sensor['data'] == 'remote_button_1') {\n      if (is_turn_off == false) {\n        $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] turn on all hue'));UDF_set_light([1, 2, 3], 'WHITE', null, null, 'WHITE');is_turn_off = true;\n      } else if (is_turn_off == true) {\n        $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] turn off all hue'));UDF_set_light([1, 2, 3], 'OFF', null, null, 'OFF');is_turn_off = false;\n      }\n    }\n   }); }else{   $engine.print(\"Rocon Authoring :\" + JSON.stringify('[Live Authoring] rf233 checker resource allocation fail'));} })($engine.allocateResource(\"rocon_ninja_block/rf233_sensors_checker\", \"rocon:/pc/rf233_sensors_checker#rocon_ninja_block/rf233_sensors_checker\", [{\"remap_from\":\"rf233_sensor_event\",\"remap_to\":\"/rf233_sensor_event\"}], [], {\"timeout\":15000,\"type\":\"dynamic\"}));","xml":"<xml xmlns=\"http://www.w3.org/1999/xhtml\"><block type=\"action_speak\" id=\"2270\" inline=\"false\" x=\"-92\" y=\"-226\"><value name=\"VALUE\"><block type=\"text\" id=\"2271\"><field name=\"TEXT\">[Live Authoring] Live authoring start</field></block></value><next><block type=\"ros_requester_allocate_with_block\" id=\"2272\"><mutation extra_config=\"{&quot;timeout&quot;:&quot;15000000&quot;,&quot;remappings&quot;:[{&quot;remap_from&quot;:&quot;/notice&quot;,&quot;remap_to&quot;:&quot;/notice&quot;}],&quot;parameters&quot;:[],&quot;rapp&quot;:&quot;concert_common_rapps/notice&quot;,&quot;uri&quot;:&quot;rocon:/aldebaran_nao&quot;}\"></mutation><field name=\"TYPE\">dynamic</field><field name=\"ON_SUCCESS_PARAM\">nao_res</field><statement name=\"ON_SUCCESS\"><block type=\"action_speak\" id=\"2273\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2274\"><field name=\"TEXT\">[Live Authoring] nao resource allocation success</field></block></value><next><block type=\"ros_subscribe_/voice_command-com.github.turtlebot.turtlebot_android.voice_commander.indigo\" id=\"2275\"><mutation extra=\"{&quot;client_app_name&quot;:&quot;com.github.turtlebot.turtlebot_android.voice_commander.indigo&quot;,&quot;tooltip&quot;:&quot;com.github.turtlebot.turtlebot_android.voice_commander.indigo&quot;}\"></mutation><field name=\"DO_PARAM\">item</field><statement name=\"DO\"><block type=\"action_speak\" id=\"2276\" inline=\"false\"><value name=\"VALUE\"><block type=\"text_join\" id=\"2277\" inline=\"false\"><mutation items=\"2\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"2278\"><field name=\"TEXT\">[Live Authoring] voice command: </field></block></value><value name=\"ADD1\"><block type=\"object_item_get\" id=\"2279\"><field name=\"VAR\">item</field><field name=\"KEY\">data</field></block></value></block></value><next><block type=\"controls_if\" id=\"2280\" inline=\"false\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"2281\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"object_item_get\" id=\"2282\"><field name=\"VAR\">item</field><field name=\"KEY\">data</field></block></value><value name=\"B\"><block type=\"text\" id=\"2283\"><field name=\"TEXT\">warning</field></block></value></block></value><statement name=\"DO0\"><block type=\"ros_scheduled_publish_/notice\" id=\"2284\" inline=\"true\"><mutation></mutation><value name=\"CTX\"><block type=\"variables_get\" id=\"2285\"><field name=\"VAR\">nao_res</field></block></value><value name=\"VALUE\"><block type=\"ros_msg_rocon_demo_msgs-Notice\" id=\"2286\" inline=\"false\"><mutation></mutation><value name=\"MESSAGE\"><block type=\"text\" id=\"2287\"><field name=\"TEXT\">warning</field></block></value><value name=\"LEVEL\"><block type=\"math_number\" id=\"2288\"><field name=\"NUM\">1</field></block></value></block></value></block></statement><value name=\"IF1\"><block type=\"logic_compare\" id=\"2289\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"object_item_get\" id=\"2290\"><field name=\"VAR\">item</field><field name=\"KEY\">data</field></block></value><value name=\"B\"><block type=\"text\" id=\"2291\"><field name=\"TEXT\">danger</field></block></value></block></value><statement name=\"DO1\"><block type=\"ros_scheduled_publish_/notice\" id=\"2292\" inline=\"true\"><mutation></mutation><value name=\"CTX\"><block type=\"variables_get\" id=\"2293\"><field name=\"VAR\">nao_res</field></block></value><value name=\"VALUE\"><block type=\"ros_msg_rocon_demo_msgs-Notice\" id=\"2294\" inline=\"false\"><mutation></mutation><value name=\"MESSAGE\"><block type=\"text\" id=\"2295\"><field name=\"TEXT\">danger</field></block></value><value name=\"LEVEL\"><block type=\"math_number\" id=\"2296\"><field name=\"NUM\">2</field></block></value></block></value></block></statement></block></next></block></statement></block></next></block></statement><statement name=\"ON_FAIL\"><block type=\"action_speak\" id=\"2297\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2298\"><field name=\"TEXT\">[Live Authoring] nao resource allocation fail</field></block></value></block></statement><next><block type=\"variables_set\" id=\"2299\" inline=\"true\"><field name=\"VAR\">is_turn_off</field><value name=\"VALUE\"><block type=\"logic_boolean\" id=\"2300\"><field name=\"BOOL\">FALSE</field></block></value><next><block type=\"ros_requester_allocate_with_block\" id=\"2301\"><mutation extra_config=\"{&quot;timeout&quot;:15000,&quot;remappings&quot;:[{&quot;remap_from&quot;:&quot;rf233_sensor_event&quot;,&quot;remap_to&quot;:&quot;/rf233_sensor_event&quot;}],&quot;parameters&quot;:[],&quot;rapp&quot;:&quot;rocon_ninja_block/rf233_sensors_checker&quot;,&quot;uri&quot;:&quot;rocon:/pc/rf233_sensors_checker#rocon_ninja_block/rf233_sensors_checker&quot;}\"></mutation><field name=\"TYPE\">dynamic</field><field name=\"ON_SUCCESS_PARAM\">rf233_checker_res</field><statement name=\"ON_SUCCESS\"><block type=\"action_speak\" id=\"2302\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2303\"><field name=\"TEXT\">[Live Authoring] rf233 checker resource allocation success</field></block></value><next><block type=\"ros_scheduled_subscribe_rf233_sensor_event\" id=\"2304\" inline=\"true\"><mutation></mutation><field name=\"DO_PARAM\">sensor</field><value name=\"CTX\"><block type=\"variables_get\" id=\"2305\"><field name=\"VAR\">rf233_checker_res</field></block></value><statement name=\"DO\"><block type=\"controls_if\" id=\"2306\" inline=\"false\"><value name=\"IF0\"><block type=\"logic_compare\" id=\"2307\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"object_item_get\" id=\"2308\"><field name=\"VAR\">sensor</field><field name=\"KEY\">data</field></block></value><value name=\"B\"><block type=\"text\" id=\"2309\"><field name=\"TEXT\">remote_button_1</field></block></value></block></value><statement name=\"DO0\"><block type=\"controls_if\" id=\"2310\" inline=\"false\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"2311\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"2312\"><field name=\"VAR\">is_turn_off</field></block></value><value name=\"B\"><block type=\"logic_boolean\" id=\"2313\"><field name=\"BOOL\">FALSE</field></block></value></block></value><statement name=\"DO0\"><block type=\"action_speak\" id=\"2314\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2315\"><field name=\"TEXT\">[Live Authoring] turn on all hue</field></block></value><next><block type=\"udf_UDF_set_light\" id=\"2316\" inline=\"false\"><value name=\"LIGHT_IDS\"><block type=\"lists_create_with\" id=\"2317\" inline=\"false\"><mutation items=\"3\"></mutation><value name=\"ADD0\"><block type=\"math_number\" id=\"2318\"><field name=\"NUM\">1</field></block></value><value name=\"ADD1\"><block type=\"math_number\" id=\"2319\"><field name=\"NUM\">2</field></block></value><value name=\"ADD2\"><block type=\"math_number\" id=\"2320\"><field name=\"NUM\">3</field></block></value></block></value><value name=\"COLOR\"><block type=\"text\" id=\"2321\"><field name=\"TEXT\">WHITE</field></block></value><next><block type=\"variables_set\" id=\"2322\" inline=\"true\"><field name=\"VAR\">is_turn_off</field><value name=\"VALUE\"><block type=\"logic_boolean\" id=\"2323\"><field name=\"BOOL\">TRUE</field></block></value></block></next></block></next></block></statement><value name=\"IF1\"><block type=\"logic_compare\" id=\"2324\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"2325\"><field name=\"VAR\">is_turn_off</field></block></value><value name=\"B\"><block type=\"logic_boolean\" id=\"2326\"><field name=\"BOOL\">TRUE</field></block></value></block></value><statement name=\"DO1\"><block type=\"action_speak\" id=\"2327\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2328\"><field name=\"TEXT\">[Live Authoring] turn off all hue</field></block></value><next><block type=\"udf_UDF_set_light\" id=\"2329\" inline=\"false\"><value name=\"LIGHT_IDS\"><block type=\"lists_create_with\" id=\"2330\" inline=\"false\"><mutation items=\"3\"></mutation><value name=\"ADD0\"><block type=\"math_number\" id=\"2331\"><field name=\"NUM\">1</field></block></value><value name=\"ADD1\"><block type=\"math_number\" id=\"2332\"><field name=\"NUM\">2</field></block></value><value name=\"ADD2\"><block type=\"math_number\" id=\"2333\"><field name=\"NUM\">3</field></block></value></block></value><value name=\"COLOR\"><block type=\"text\" id=\"2334\"><field name=\"TEXT\">OFF</field></block></value><next><block type=\"variables_set\" id=\"2335\" inline=\"true\"><field name=\"VAR\">is_turn_off</field><value name=\"VALUE\"><block type=\"logic_boolean\" id=\"2336\"><field name=\"BOOL\">FALSE</field></block></value></block></next></block></next></block></statement></block></statement></block></statement></block></next></block></statement><statement name=\"ON_FAIL\"><block type=\"action_speak\" id=\"2337\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"2338\"><field name=\"TEXT\">[Live Authoring] rf233 checker resource allocation fail</field></block></value></block></statement></block></next></block></next></block></next></block></xml>","title":"live_authoring_wf","description":"Service Description","created_at":1434355540202}