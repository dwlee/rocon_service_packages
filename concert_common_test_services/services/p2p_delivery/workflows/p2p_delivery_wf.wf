{"id":"9af60854b6ba62362979030328b36fbe","title":"p2p_delivery_wf","js":"var item;\nvar p2p_waiterbot;\n\n\n$engine.print(\"Rocon Authoring :\" + JSON.stringify('Start P2P delivery service'));\n$engine.subscribe('/p2p_delivery_order', 'simple_delivery_msgs/P2PDeliveryOrder', function(item){   $engine.print(\"Rocon Authoring :\" + JSON.stringify(['[p2p_delivery_order id] ',item['id '],'[from] ',item['from'],'[to] ',item['to']].join('')));(function(p2p_waiterbot){ if(p2p_waiterbot){   $engine.print(\"Rocon Authoring :\" + JSON.stringify('Resource allocation succeeded for P2P delivery'));$engine.runScheduledAction(p2p_waiterbot, \"p2p_delivery_order\", \"simple_delivery_msgs/P2PDeliveryOrderAction\", ({\"order_id\":item['id '],\"from\":item['from'],\"to\":item['to'],\"message\":'Hello'}), function(item){   $engine.print(\"Rocon Authoring :\" + JSON.stringify(['[order_id] ',item['order_id '],'[success] ',item['success']].join('')));$engine.releaseResource(p2p_waiterbot);}, function(item){   $engine.print(\"Rocon Authoring :\" + JSON.stringify(['[order_id] ',item['order_id '],'[status] ',item['status']].join('')));}); }else{   $engine.print(\"Rocon Authoring :\" + JSON.stringify('Resource allocation failed for P2P delivery'));} })($engine.allocateResource(\"concert_demo_rapps/p2p_delivery\", \"rocon:/waiterbot|turtlebot|pc\", [{\"remap_from\":\"map\",\"remap_to\":\"/map\"},{\"remap_from\":\"map_metadata\",\"remap_to\":\"/map_metadata\"},{\"remap_from\":\"location_list\",\"remap_to\":\"/location_list\"},{\"remap_from\":\"global_marker_list\",\"remap_to\":\"/global_marker_list\"},{\"remap_from\":\"robot_pose\",\"remap_to\":\"/robot_pose\"},{\"remap_from\":\"robot_status\",\"remap_to\":\"/robot_status\"},{\"remap_from\":\"p2p_delivery_order\",\"remap_to\":\"/p2p_delivery_order\"},{\"remap_from\":\"\",\"remap_to\":\"\"}], [{\"key\":\"volume\",\"value\":\"80\"}], {\"type\":\"dynamic\",\"timeout\":$engine.getServiceParameter('p2p_delivery', 'alloc_timeout')})); });","xml":"<xml xmlns=\"http://www.w3.org/1999/xhtml\"><block type=\"action_speak\" id=\"131\" inline=\"false\" x=\"31\" y=\"25\"><value name=\"VALUE\"><block type=\"text\" id=\"132\"><field name=\"TEXT\">Start P2P delivery service</field></block></value></block><block type=\"ros_subscribe\" id=\"4323\" inline=\"true\" x=\"34\" y=\"85\"><mutation></mutation><field name=\"DO_PARAM\">item</field><value name=\"NAME\"><block type=\"text\" id=\"4324\"><field name=\"TEXT\">/p2p_delivery_order</field></block></value><value name=\"TYPE\"><block type=\"text\" id=\"4325\"><field name=\"TEXT\">simple_delivery_msgs/P2PDeliveryOrder</field></block></value><statement name=\"DO\"><block type=\"action_speak\" id=\"4326\" inline=\"false\"><value name=\"VALUE\"><block type=\"text_join\" id=\"4371\" inline=\"false\"><mutation items=\"6\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"4431\"><field name=\"TEXT\">[p2p_delivery_order id] </field></block></value><value name=\"ADD1\"><block type=\"object_item_get\" id=\"4563\"><field name=\"VAR\">item</field><field name=\"KEY\">id </field></block></value><value name=\"ADD2\"><block type=\"text\" id=\"4570\"><field name=\"TEXT\">[from] </field></block></value><value name=\"ADD3\"><block type=\"object_item_get\" id=\"4571\"><field name=\"VAR\">item</field><field name=\"KEY\">from</field></block></value><value name=\"ADD4\"><block type=\"text\" id=\"4580\"><field name=\"TEXT\">[to] </field></block></value><value name=\"ADD5\"><block type=\"object_item_get\" id=\"4581\"><field name=\"VAR\">item</field><field name=\"KEY\">to</field></block></value></block></value><next><block type=\"ros_requester_allocate_with_block2\" id=\"5631\" inline=\"false\"><mutation extra_config=\"{&quot;timeout&quot;:15000,&quot;remappings&quot;:[{&quot;remap_from&quot;:&quot;map&quot;,&quot;remap_to&quot;:&quot;/map&quot;},{&quot;remap_from&quot;:&quot;map_metadata&quot;,&quot;remap_to&quot;:&quot;/map_metadata&quot;},{&quot;remap_from&quot;:&quot;location_list&quot;,&quot;remap_to&quot;:&quot;/location_list&quot;},{&quot;remap_from&quot;:&quot;global_marker_list&quot;,&quot;remap_to&quot;:&quot;/global_marker_list&quot;},{&quot;remap_from&quot;:&quot;robot_pose&quot;,&quot;remap_to&quot;:&quot;/robot_pose&quot;},{&quot;remap_from&quot;:&quot;robot_status&quot;,&quot;remap_to&quot;:&quot;/robot_status&quot;},{&quot;remap_from&quot;:&quot;p2p_delivery_order&quot;,&quot;remap_to&quot;:&quot;/p2p_delivery_order&quot;},{&quot;remap_from&quot;:&quot;&quot;,&quot;remap_to&quot;:&quot;&quot;}],&quot;parameters&quot;:[{&quot;key&quot;:&quot;volume&quot;,&quot;value&quot;:&quot;80&quot;}],&quot;rapp&quot;:&quot;concert_demo_rapps/p2p_delivery&quot;,&quot;uri&quot;:&quot;rocon:/waiterbot|turtlebot|pc&quot;}\"></mutation><field name=\"TYPE\">dynamic</field><field name=\"ON_SUCCESS_PARAM\">p2p_waiterbot</field><value name=\"TIMEOUT_ALLOC\"><block type=\"ros_parameter\" id=\"6726\"><mutation></mutation><field name=\"KEY\">alloc_timeout</field></block></value><statement name=\"ON_SUCCESS\"><block type=\"action_speak\" id=\"7785\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"7786\"><field name=\"TEXT\">Resource allocation succeeded for P2P delivery</field></block></value><next><block type=\"ros_scheduled_action_p2p_delivery_order\" id=\"7779\" inline=\"true\"><mutation></mutation><field name=\"ON_RESULT_PARAM\">item</field><field name=\"ON_FEEDBACK_PARAM\">item</field><value name=\"CTX\"><block type=\"variables_get\" id=\"7791\"><field name=\"VAR\">p2p_waiterbot</field></block></value><value name=\"GOAL\"><block type=\"ros_msg_simple_delivery_msgs-P2PDeliveryOrderGoal\" id=\"7780\" inline=\"false\"><mutation></mutation><value name=\"ORDER_ID\"><block type=\"object_item_get\" id=\"7792\"><field name=\"VAR\">item</field><field name=\"KEY\">id </field></block></value><value name=\"FROM\"><block type=\"object_item_get\" id=\"7793\"><field name=\"VAR\">item</field><field name=\"KEY\">from</field></block></value><value name=\"TO\"><block type=\"object_item_get\" id=\"7794\"><field name=\"VAR\">item</field><field name=\"KEY\">to</field></block></value><value name=\"MESSAGE\"><block type=\"text\" id=\"7784\"><field name=\"TEXT\">Hello</field></block></value></block></value><statement name=\"ON_RESULT\"><block type=\"action_speak\" id=\"7799\" inline=\"false\"><value name=\"VALUE\"><block type=\"text_join\" id=\"7800\" inline=\"false\"><mutation items=\"4\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"7801\"><field name=\"TEXT\">[order_id] </field></block></value><value name=\"ADD1\"><block type=\"object_item_get\" id=\"7802\"><field name=\"VAR\">item</field><field name=\"KEY\">order_id </field></block></value><value name=\"ADD2\"><block type=\"text\" id=\"7815\"><field name=\"TEXT\">[success] </field></block></value><value name=\"ADD3\"><block type=\"object_item_get\" id=\"7804\"><field name=\"VAR\">item</field><field name=\"KEY\">success</field></block></value></block></value><next><block type=\"ros_requester_release\" id=\"8874\" inline=\"false\"><mutation></mutation><value name=\"CTX\"><block type=\"variables_get\" id=\"8879\"><field name=\"VAR\">p2p_waiterbot</field></block></value></block></next></block></statement><statement name=\"ON_FEEDBACK\"><block type=\"action_speak\" id=\"7821\" inline=\"false\"><value name=\"VALUE\"><block type=\"text_join\" id=\"7822\" inline=\"false\"><mutation items=\"4\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"7823\"><field name=\"TEXT\">[order_id] </field></block></value><value name=\"ADD1\"><block type=\"object_item_get\" id=\"7824\"><field name=\"VAR\">item</field><field name=\"KEY\">order_id </field></block></value><value name=\"ADD2\"><block type=\"text\" id=\"7825\"><field name=\"TEXT\">[status] </field></block></value><value name=\"ADD3\"><block type=\"object_item_get\" id=\"7826\"><field name=\"VAR\">item</field><field name=\"KEY\">status</field></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ON_FAIL\"><block type=\"action_speak\" id=\"5634\" inline=\"false\"><value name=\"VALUE\"><block type=\"text\" id=\"5635\"><field name=\"TEXT\">Resource allocation failed for P2P delivery</field></block></value></block></statement></block></next></block></statement></block></xml>","description":"Service Description","created_at":1442540360340}